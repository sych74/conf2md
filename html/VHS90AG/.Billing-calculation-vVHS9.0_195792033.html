<!DOCTYPE html>
<html>
    <head>
        <title>Virtuozzo Hybrid Server 9.0 Admin Guide : .Billing calculation vVHS9.0</title>
        <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>

    <body class="theme-default aui-theme-default">
        <div id="page">
            <div id="main" class="aui-page-panel">
                <div id="main-header">
                    <div id="breadcrumb-section">
                        <ol id="breadcrumbs">
                            <li class="first">
                                <span><a href="index.html">Virtuozzo Hybrid Server 9.0 Admin Guide</a></span>
                            </li>
                                                    <li>
                                <span><a href="Virtuozzo-Hybrid-Server-9.0-Admin-Guide_195791490.html">Virtuozzo Hybrid Server 9.0 Admin Guide</a></span>
                            </li>
                                                    <li>
                                <span><a href="Control-Panel-Administration_195792528.html">Control Panel Administration</a></span>
                            </li>
                                                    <li>
                                <span><a href="Billing_195792025.html">Billing</a></span>
                            </li>
                                                    <li>
                                <span><a href="Buckets_195792029.html">Buckets</a></span>
                            </li>
                                                    <li>
                                <span><a href="Billing-Calculation_195792034.html">Billing Calculation</a></span>
                            </li>
                                                </ol>
                    </div>
                    <h1 id="title-heading" class="pagetitle">
                                                <span id="title-text">
                            Virtuozzo Hybrid Server 9.0 Admin Guide : .Billing calculation vVHS9.0
                        </span>
                    </h1>
                </div>

                <div id="content" class="view">
                    <div class="page-metadata">
                        
        
    
    
        
    
        
        
            Created by <span class='author'> Roksoliana Ben</span>, last modified on May 07, 2024
                        </div>
                    <div id="main-content" class="wiki-content group">
                    <p><span style="color: rgb(51,51,51);text-decoration: none;">Below you will find the description of the billing logic and how the billing is calculated for the following bucket resources:</span></p><ul><li><a href="#id-.BillingcalculationvVHS9.0-free">Free limits</a></li><li><a href="#id-.BillingcalculationvVHS9.0-hourly">Free and free per month limit types</a></li><li><a href="#id-.BillingcalculationvVHS9.0-missing">Calculation for the missing period</a></li><li><a href="#id-.BillingcalculationvVHS9.0-ipaddress">IP addresses</a></li><li><p><a href="#id-.BillingcalculationvVHS9.0-portspeed">Port speed</a></p></li><li><p><a href="#id-.BillingcalculationvVHS9.0-miniops"> Guaranteed minIOPS </a></p></li><li><p><a href="#id-.BillingcalculationvVHS9.0-disksize"> Disk size </a></p></li><li><p><a href="#id-.BillingcalculationvVHS9.0-cpu"> CPU </a></p></li><li><p><a href="#id-.BillingcalculationvVHS9.0-priority"> CPU priority </a></p></li><li><p><a href="#id-.BillingcalculationvVHS9.0-shares"> CPU shares </a></p></li><li><a href="#id-.BillingcalculationvVHS9.0-units">CPU units</a></li></ul><div class="confluence-information-macro confluence-information-macro-information"><span class="aui-icon aui-icon-small aui-iconfont-info confluence-information-macro-icon"></span><div class="confluence-information-macro-body"><p>If you remove from the bucket a resource with a virtual machine(s) running on it, the pricing for that resource will be removed for such VMs. This behavior refers to user VM limits, template stores, edge groups, recipe groups, backup server zones, and guaranteed minIOPS.</p></div></div><div class="confluence-information-macro confluence-information-macro-note"><span class="aui-icon aui-icon-small aui-iconfont-warning confluence-information-macro-icon"></span><div class="confluence-information-macro-body"><p>Ignore the options specified in your Control Panel but not mentioned in the documents.</p></div></div><hr/><h2 id="id-.BillingcalculationvVHS9.0-freeFreeLimits"><span class="confluence-anchor-link" id="id-.BillingcalculationvVHS9.0-free"></span>Free Limits</h2><p>To calculate the free limits, the system first adds up all resources as if there were no free limits configured and then, at the end of the hour, subtracts the cost of free resources from the total amount of used resources.</p><p>For example, a user's bucket has the free limit for acceleration set to '2' (VM/hr) and the price for acceleration set to '5 VMs'. If this user creates four VMs with acceleration enabled, at first, the system will calculate the price of all the machines excluding the free limit: 4*5=20. At the end of the billing period (hour), the system will subtract the price of the free resources, in this case, 2*5=10, from the total amount for the used resource: 20-10=10.</p><hr/><h2 id="id-.BillingcalculationvVHS9.0-hourlyFreeandFreeperMonthResourceLimitTypes"><span class="confluence-anchor-link" id="id-.BillingcalculationvVHS9.0-hourly"></span>Free and Free per Month Resource Limit Types</h2><p>It is possible to choose hourly or monthly free limits when adding a data store or network zone resources to the OnApp bucket.</p><p>When setting the 'free' resource type, the limit for resources is set per hour, and the statistics are gathered hourly and then compared to the free resource limit. Then, the resource limits which exceed the free amount allowed are billed.<span><br/></span></p><p>When setting the ''free per month' resource type, the limit for resources is set per month, and the statistics are gathered hourly and then compared to the free resource limit set per month. When the free limit set per month is exceeded, the exceeding amount is billed based on the overusage price per resource per hour.</p><div id="expander-1401786607" class="expand-container"><div id="expander-control-1401786607" class="expand-control" aria-expanded="true"><span class="expand-icon aui-icon aui-icon-small aui-iconfont-chevron-down"></span><span class="expand-control-text">Click to see the example</span></div><div id="expander-content-1401786607" class="expand-content"><p>For example, a user adds a data store zone with 'free per month' limits to the bucket and sets free data read limit per month to 50 GB:</p><ul><li>During the first hour, 50 GB is used (all the free limit).</li><li>During the second hour, 2 GB is used. As there’s no free limit left, the user is charged for 2 GB per hour.</li><li>During the third hour, 5 GB are used. Since there’s no free limit left, the user is charged for 5 GB per hour (the previous 2 GB over the limit are not taken into account, since they are already billed).</li></ul><p>If a user adds a data store zone with 'free' limits to the billing plan and sets free data read limit per hour to 50 GB:</p><ul><li>During the first hour, 5 GB is used. As the free limit is 50GB the user is not charged (all the free limit).</li><li>During the second hour, 52 GB are used. The user is charged for 2 GB over the free limit per hour.</li><li>During the third hour, 55 GB are used. The user is charged for 5 GB per hour overusage (the previous 2 GB over the limit are not taken into account since they are already billed).</li></ul></div></div><hr/><h2 id="id-.BillingcalculationvVHS9.0-missingCalculationforMissingPeriod"><span class="confluence-anchor-link" id="id-.BillingcalculationvVHS9.0-missing"></span>Calculation for Missing Period</h2><p>Under certain circumstances, statistics might be missing for a while. This might happen due to daemon issues, cron job failures, or some other unexpected errors with the statistics collection mechanism. In such cases, the instant (raw) statistics are aggregated for the whole missing period, and the calculated amount is added to the hourly statistics for the first hour when the services are up again. This behavior is relevant only to the resources calculated dynamically on an hourly basis, in particular:</p><div class="table-wrap"><table class="wrapped confluenceTable"><colgroup><col/><col/></colgroup><tbody><tr><td rowspan="4" class="confluenceTd"><br/><br/><span>Data store zones</span><br/><br/></td><td colspan="1" class="confluenceTd"><span>Data read</span></td></tr><tr><td colspan="1" class="confluenceTd"><span>Data written</span></td></tr><tr><td colspan="1" class="confluenceTd"><span>Input requests</span></td></tr><tr><td colspan="1" class="confluenceTd"><span>Output requests</span></td></tr><tr><td rowspan="2" class="confluenceTd"><br/><span>Network zones</span></td><td colspan="1" class="confluenceTd"><span>Data received</span></td></tr><tr><td colspan="1" class="confluenceTd"><span>Data sent</span></td></tr></tbody></table></div><div id="expander-1161954378" class="expand-container"><div id="expander-control-1161954378" class="expand-control" aria-expanded="true"><span class="expand-icon aui-icon aui-icon-small aui-iconfont-chevron-down"></span><span class="expand-control-text">Click to see the example</span></div><div id="expander-content-1161954378" class="expand-content"><p>The following scheme demonstrates this behavior for Data Received for network zones as an example:</p><p><strong><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image confluence-content-image-border" draggable="false" width="700" src="attachments/195792033/195792035.png" data-image-src="attachments/195792033/195792035.png" data-unresolved-comment-count="0" data-linked-resource-id="195792035" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="missing_period2.png" data-base-url="https://docs.onapp.com" data-linked-resource-content-type="image/png" data-linked-resource-container-id="195792033" data-linked-resource-container-version="13" alt=""></span></strong></p><p>The last value for data received (Hour1) reported as hourly statistics for the network zone in question was 10 GB. Then the OnApp daemon stopped working, and no hourly statistics were generated for Hour2, Hour3, Hour4, and Hour5. On Hour6 the problem was fixed, and the daemon was up again. The hourly statistics for Hour6 will aggregate all the statistics for the whole missing period into that hour. Most probably you will get a huge value for the Hour6 as it will be the summary for the whole period when no stats have been reported. Pay attention that the Outstanding amount and Total amount for users will be calculated as per one hour: the whole aggregated statistics will be regarded as statistics per one hour, and compared to the free limits and charged for overusage. </p></div></div><div class="confluence-information-macro confluence-information-macro-tip"><span class="aui-icon aui-icon-small aui-iconfont-approve confluence-information-macro-icon"></span><div class="confluence-information-macro-body"><p>As a workaround, to fix the overcharging for the aggregated stats, you can use the <a href=".Payments-vVHS9.0_195792069.html">payments&nbsp;</a>functionality. Add the appropriate value as a payment for a user, and it will be subtracted from the Total amount.</p></div></div><p><span>Each virtual machine has two IP types: regular and outside. Public IP addresses are used for servers’ Internet access. Private IP addresses are used for private networks.</span></p><hr/><h2 id="id-.BillingcalculationvVHS9.0-ipaddressIPaddresses"><span class="confluence-anchor-link" id="id-.BillingcalculationvVHS9.0-ipaddress"></span>IP addresses</h2><p>When calculating IP address billing for a particular resource, each virtual machine’s IP address is compared to the free IP limit in a linear queue (starting with the first added IP address). Regular IPs are calculated first.   </p><div id="expander-1013715731" class="expand-container"><div id="expander-control-1013715731" class="expand-control" aria-expanded="true"><span class="expand-icon aui-icon aui-icon-small aui-iconfont-chevron-down"></span><span class="expand-control-text">Click to see the example</span></div><div id="expander-content-1013715731" class="expand-content"><p><strong><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image confluence-thumbnail confluence-content-image-border" draggable="false" width="300" src="attachments/195792033/195792036.png" data-image-src="attachments/195792033/195792036.png" data-unresolved-comment-count="0" data-linked-resource-id="195792036" data-linked-resource-version="2" data-linked-resource-type="attachment" data-linked-resource-default-alias="IPs.png" data-base-url="https://docs.onapp.com" data-linked-resource-content-type="image/png" data-linked-resource-container-id="195792033" data-linked-resource-container-version="13" alt=""></span></strong></p><p><strong>Example</strong></p><p>The free IP address limit is 3.</p><p><strong>VM 1</strong></p><p>The first virtual machine has two regular and two outside IP addresses, but the second regular IP address is the same as the second outside IP address, so the number of unique IPs assigned to this virtual machine is 3.</p><p><strong>VM2</strong></p><p>The second virtual machine has two regular and two outside IP addresses.</p><p>According to the billing algorithm, the first regular IP address checks if there are some IPs added before it and then gets compared to the free IP address limit. 1 &lt; 3, so it is not charged (2 IPs of free limit left).</p><p>Then, the second IP address is compared to the remaining free IP address number. 1 &lt; 2, so the second IP also is not charged (1 IP of free limit left).</p><p>After that, the outside IPs are calculated:</p><p>The first outside IP address checks if there are some outside IPs added before it and then gets compared to the free IP address limit.</p><p>1 ≥1, so this IP address is not charged (0 IP of free limit left).</p><p>Then, the second outside IP is compared to the remaining free IP address number. There are no free IPs left, but since the second regular IP address equals the second outside IP address, the second IP also is not billed.</p><p>Consequently, all IP addresses of the second virtual machine are billed, as the free IP address limit is already used up.</p></div></div><div class="confluence-information-macro confluence-information-macro-information"><span class="aui-icon aui-icon-small aui-iconfont-info confluence-information-macro-icon"></span><div class="confluence-information-macro-body"><p>One IP address can be added as a regular and an outside IP at the same time. In this case, it will be only charged as a regular one. That is why outside IPs are calculated second.</p></div></div><hr/><h2 id="id-.BillingcalculationvVHS9.0-portPortSpeed"><span class="confluence-anchor-link" id="id-.BillingcalculationvVHS9.0-port"></span>Port Speed</h2><p>Port speed is calculated by subtracting the free port speed value from the free port speed limit and summing up the remainders. If the port speed is less than the free port speed limit, it is not billed.</p><p>If the NIC port speed is set as Unlimited in the bucket, it means that the maximum port speed value is the value specified in the Control Panel &gt; <strong>Admin</strong> &gt; <strong>Settings</strong> &gt; <strong>Configuration</strong> &gt; <strong>Max network interface port speed</strong> field.</p><div class="panel" style="border-width: 1px;"><div class="panelHeader" style="border-bottom-width: 1px;"><b>Formula for port speed billing calculation</b></div><div class="panelContent">
<p>(NIC 1 port speed - free port speed value) + (NIC 2 port speed - free port speed value)..etc</p>
</div></div><div id="expander-1067561805" class="expand-container"><div id="expander-control-1067561805" class="expand-control" aria-expanded="true"><span class="expand-icon aui-icon aui-icon-small aui-iconfont-chevron-down"></span><span class="expand-control-text">Click to see the example</span></div><div id="expander-content-1067561805" class="expand-content"><p><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image confluence-content-image-border" draggable="false" width="300" src="attachments/195792033/195792037.png" data-image-src="attachments/195792033/195792037.png" data-unresolved-comment-count="0" data-linked-resource-id="195792037" data-linked-resource-version="3" data-linked-resource-type="attachment" data-linked-resource-default-alias="portspeed.png" data-base-url="https://docs.onapp.com" data-linked-resource-content-type="image/png" data-linked-resource-container-id="195792033" data-linked-resource-container-version="13" alt=""></span></p><p><strong>Example</strong><br/>In this example, the free port speed limit is 20 MBps.</p><p><strong>VM 1  </strong></p><p>The first virtual machine has two NICs.</p><p>NIC 1 = 10 MBps</p><p>NIC 2 = 25 MBps </p><p><strong>VM 2</strong></p><p>The second virtual machine has two NICs.</p><p>NIC 3 = 10 MBps</p><p>NIC 4 = 30 MBps</p><p>Then, (10 - 20) + (25 - 20) + (10 - 20) + (30 - 20) = 15 MB will be charged.</p><p><br/></p><p>Since the first and the third NICs are less than the free amount, they are not charged.</p></div></div><hr/><h2 id="id-.BillingcalculationvVHS9.0-miniopsGuaranteedminIOPS"><span class="confluence-anchor-link" id="id-.BillingcalculationvVHS9.0-miniops"></span>Guaranteed minIOPS</h2><p>Guaranteed minIOPS is calculated by subtracting the free IOPS value from each disk’s IOPS and summing up the remainders. If the disk’s IOPS is less than the free IOPS value, it is not billed.</p><div class="panel" style="border-width: 1px;"><div class="panelHeader" style="border-bottom-width: 1px;"><b>Formula for minIOPS billing calculation</b></div><div class="panelContent">
<p>(Disk 1 IOPS - free IOPS value) + (Disk 2 IOPS - free IOPS value)...etc</p>
</div></div><div id="expander-444169027" class="expand-container"><div id="expander-control-444169027" class="expand-control" aria-expanded="true"><span class="expand-icon aui-icon aui-icon-small aui-iconfont-chevron-down"></span><span class="expand-control-text">Click to see the example</span></div><div id="expander-content-444169027" class="expand-content"><p><strong><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image confluence-content-image-border" draggable="false" width="300" src="attachments/195792033/195792038.png" data-image-src="attachments/195792033/195792038.png" data-unresolved-comment-count="0" data-linked-resource-id="195792038" data-linked-resource-version="2" data-linked-resource-type="attachment" data-linked-resource-default-alias="miniops.png" data-base-url="https://docs.onapp.com" data-linked-resource-content-type="image/png" data-linked-resource-container-id="195792033" data-linked-resource-container-version="13" alt=""></span>Example</strong><br/>In this example, free IOPS = 45</p><p>Disk 1 has 50 IOPS</p><p>Disk 2 has 45 IOPS</p><p>Disk 2 has 60 IOPS</p><p>Disk 4 has 20 IOPS</p><p> Then: (50-45) + (45-45) + (60-45) + (20-45) = 20 IOPS which is billed.</p><p>Since the second and the fourth disks’ IOPS values are less than the free amount, these disks are not billed.</p></div></div><hr/><h2 id="id-.BillingcalculationvVHS9.0-disksizeDisksize"><span class="confluence-anchor-link" id="id-.BillingcalculationvVHS9.0-disksize"></span>Disk size</h2><p>When calculating disk size billing for a particular resource, each virtual machine’s disk size is compared to the free disk size limit in a linear queue (starting with the first added disk), and then each next disk is compared to the free disk size limit remainders.</p><div id="expander-549641117" class="expand-container"><div id="expander-control-549641117" class="expand-control" aria-expanded="true"><span class="expand-icon aui-icon aui-icon-small aui-iconfont-chevron-down"></span><span class="expand-control-text">Click to see the example</span></div><div id="expander-content-549641117" class="expand-content"><p><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image confluence-content-image-border" draggable="false" width="300" src="attachments/195792033/195792039.png" data-image-src="attachments/195792033/195792039.png" data-unresolved-comment-count="0" data-linked-resource-id="195792039" data-linked-resource-version="3" data-linked-resource-type="attachment" data-linked-resource-default-alias="disksize.png" data-base-url="https://docs.onapp.com" data-linked-resource-content-type="image/png" data-linked-resource-container-id="195792033" data-linked-resource-container-version="13" alt=""></span></p><p><strong>Example</strong></p><p>The free disk size is 50 GB.</p><p>We have two virtual machines assigned to the same data store.</p><p><strong>VM 1</strong>   </p><p>The first virtual machine has two disks.  </p><p>Disk 1 = 15 GB</p><p>Disk 2 = 20 GB</p><p><strong>VM 2</strong></p><p>The second virtual machine has two disks.</p><p>Disk 1 = 20 GB</p><p>Disk 2 = 15 GB </p><p>According to the billing algorithm, the first disk checks if there are disks added before it and then gets compared to the free disk size limit:</p><p>15&lt; 50, so it is not charged (35 GB of free disk size limit left).</p><p>Then, the second disk is compared to the remaining free disk size limit:</p><p>20 &lt; 35 (15 GB of free disk size limit left).</p><p>So, the second disk is also not charged.</p><p>After that, the second virtual machine’s disks are processed. The third disk is compared to the remaining free disk size limit:</p><p>20 &gt;15 (20 - 15 = 5, so 5 GB of the disk’s size will be charged).</p><p>Finally, the fourth disk is charged for the whole disk size, as the free disk size limit is already reached.</p></div></div><hr/><h2 id="id-.BillingcalculationvVHS9.0-cpuCPU"><span class="confluence-anchor-link" id="id-.BillingcalculationvVHS9.0-cpu"></span>CPU</h2><p>CPU, CPU shares, and memory limits are set for the compute zone. </p><p>When calculating CPU billing for a particular resource, the sum of all virtual machine’s CPU over the free limit is billed.</p><div class="panel" style="border-width: 1px;"><div class="panelHeader" style="border-bottom-width: 1px;"><b>Formula for the CPU billing calculation</b></div><div class="panelContent">
<p>(VM1 CPUs) + (V2 CPUs) + (VM# CPUs) - free CPU limit</p>
</div></div><div id="expander-184834106" class="expand-container"><div id="expander-control-184834106" class="expand-control" aria-expanded="true"><span class="expand-icon aui-icon aui-icon-small aui-iconfont-chevron-down"></span><span class="expand-control-text">Click to see the example</span></div><div id="expander-content-184834106" class="expand-content"><p><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image confluence-content-image-border" draggable="false" width="300" src="attachments/195792033/195792040.png" data-image-src="attachments/195792033/195792040.png" data-unresolved-comment-count="0" data-linked-resource-id="195792040" data-linked-resource-version="2" data-linked-resource-type="attachment" data-linked-resource-default-alias="cdc.PNG" data-base-url="https://docs.onapp.com" data-linked-resource-content-type="image/png" data-linked-resource-container-id="195792033" data-linked-resource-container-version="13" alt=""></span></p><p><strong>Example</strong></p><p>The free CPU limit is 3.</p><p>If we have two virtual machines:</p><p><strong>VM 1</strong></p><p>The first VM has 2 CPUs</p><p><strong>VM 2</strong></p><p>The second VM has 3 CPUs</p><p>The number of CPUs charged: (2+3) - 3 = 2</p></div></div><hr/><h2 id="id-.BillingcalculationvVHS9.0-sharesCPUShares"><span class="confluence-anchor-link" id="id-.BillingcalculationvVHS9.0-shares"></span>CPU Shares </h2><p>To calculate the CPU shares price for the virtual machine, multiply the number of machine’s cores by the CPU priority percentage given.</p><p>Then, each virtual machine’s CPU priority value is compared to the free CPU shares limit in a linear queue (starting with the first added virtual machine), and then each next virtual machine is compared to the free CPU shares limit remainders.</p><div id="expander-940876679" class="expand-container"><div id="expander-control-940876679" class="expand-control" aria-expanded="true"><span class="expand-icon aui-icon aui-icon-small aui-iconfont-chevron-down"></span><span class="expand-control-text">Click to see the example</span></div><div id="expander-content-940876679" class="expand-content"><p>In this example, the free CPU share limit is 140.</p><p><strong>VM 1</strong></p><p>The first virtual machine has 2 CPUs and 50% CPU priority (100%).<br/> <strong>VM 2</strong></p><p>The second virtual machine has 3 CPUs and 40% CPU priority (120%).</p><p>According to the billing algorithm, the first virtual machine checks if there are machines added before it and then gets compared to the free CPU shares limit:</p><p>100 &lt; 140, so it is not charged (40 of free CPU shares limit left).</p><p>Then, the second virtual machine is compared to the remaining CPU shares limit:</p><p>120 &gt; 40 (120 – 40 = 80), so 80 percent of this machine’s CPU shares will be charged.</p></div></div><hr/><h2 id="id-.BillingcalculationvVHS9.0-priorityCPUPriority"><span class="confluence-anchor-link" id="id-.BillingcalculationvVHS9.0-priority"></span>CPU Priority</h2><p>The amount of CPU resource a VM is given is the CPU priority (you can think of this as its &quot;share percentage&quot;) multiplied by the number of cores allocated to that VM. This is a minimum number – clients can burst over it by manually adding up to 100% multiplied by the number of cores. You may do it by modifying the CPU priority value at the Adjust Resource Allocation page (<strong>Cloud</strong> &gt; <strong>Virtual Servers</strong> &gt;<em> the label of the desired VM</em> &gt; <strong>Actions </strong>&gt; <strong>Options</strong> &gt; <strong>Edit Virtual Server</strong>). For example, on a compute resource with 3 GHz CPU cores:</p><ul><li>100% x 1 core = 3 GHz (burstable to 3 GHz)</li><li>10% x 2 cores = 600 MHZ (burstable to 6 GHz)</li><li>5 % x 4 cores = 600 MHz (burstable to 12 GHz)</li></ul><p>In other words, you can create either one VM with 100% CPU priority on that HV or five VMs with 20% CPU priority (or any other combinations with a total of 100%).</p><p>By default, OnApp allows overselling of cloud resources. For example, OnApp will enable users to create five VMs with 100% CPU priority/1 CPU core on a compute resource with a 4-core CPU. In this example, OnApp would reduce the guaranteed CPU for each VM.<br/>If you build a VM on a KVM compute resource, the CPU priority settings will be disabled and the CPU priority value will be 100 by default.</p><div id="expander-1148331753" class="expand-container"><div id="expander-control-1148331753" class="expand-control" aria-expanded="true"><span class="expand-icon aui-icon aui-icon-small aui-iconfont-chevron-down"></span><span class="expand-control-text">Click here to explore more</span></div><div id="expander-content-1148331753" class="expand-content"><p>Depending on the settings of your cloud (<strong>CPU Guarantee</strong>), OnApp may allow overselling of cloud resources. For example, OnApp will allow you to create five virtual machines with 100% CPU priority/1 CPU core on a compute resource with a 4-core CPU. In this example, OnApp would reduce the guaranteed CPU for each virtual machine.</p><p>If resource overselling is disabled for your cloud, OnApp will not create virtual machines requiring more CPU resources than it is available on the hypervisor.</p></div></div><hr/><h2 id="id-.BillingcalculationvVHS9.0-unitsCPUUnits"><span class="confluence-anchor-link" id="id-.BillingcalculationvVHS9.0-units"></span>CPU Units</h2><p>The CPU unit is an abstract figure that replaces CPU priority.  It is an arbitrary relative value that the host can enter to mark the capacity of the compute resources in a zone. It is the host's responsibility to enter the values per compute resource correctly and logically. You can set the number of units per compute zone and per particular compute resource in a zone. If you set the CPU Units per compute zone, each compute resource in this zone will be assigned the number of units set. To set different capacities to a particular compute resource, specify the CPU units amount to a required compute resource, not a zone. To bill for CPU Units, enable CPU units for a bucket and set the price per unit.</p><p>Each compute resource core within a zone is given a 1000 CPU Units default value when CPU units are enabled per zone (this is made in the bucket). The Host can then change that number for each compute resource to any other number between 1-100,000 to fit its capacity. The faster the compute resource, the higher the value should be set.</p><p>CPU Units show the speed of the CPU - this can be done in any way that the host wants to as it’s just a number that is relative to another number. OnApp will simply process the numbers. For example, if one compute resource is two times more powerful than another, then the CPU units could be 1000 and 500.</p><p><span>To evaluate the compute resource’s physical performance, you can take the following values:</span><span> </span></p><ol><li><span>CPU Mhz</span><span> </span></li><li><span>Passmark Score (<a href="http://www.cpubenchmark.net/" class="external-link" rel="nofollow">http://www.cpubenchmark.net/</a>)</span><span> </span></li><li><span>BogoMips (</span><a href="http://en.wikipedia.org/wiki/BogoMips" class="external-link" rel="nofollow"><span>http://en.wikipedia.org/wiki/BogoMips</span></a><span>)</span></li></ol><p><span>When creating a VM, you will specify the desired amount of CPU Units that this VM will take out of the total CPU Units set for compute resource.</span></p><div class="confluence-information-macro confluence-information-macro-note"><span class="aui-icon aui-icon-small aui-iconfont-warning confluence-information-macro-icon"></span><div class="confluence-information-macro-body">Please note that OnApp cannot guarantee identical performance over different compute resources and workload types when migrating VMs.</div></div><div id="expander-1333762186" class="expand-container"><div id="expander-control-1333762186" class="expand-control" aria-expanded="true"><span class="expand-icon aui-icon aui-icon-small aui-iconfont-chevron-down"></span><span class="expand-control-text">Click to see the example</span></div><div id="expander-content-1333762186" class="expand-content"><p><strong>Example</strong>: If you have a compute zone (Compute resourceZ) with five compute resources attached to it, and you set 1000 CPU Units to Compute resourceZ zone, then each of the five compute resources in this zone will have 1000 CPU Units. If you would like to increase the capacity of specific Compute resource1 compute resource to 2000 in this Compute resourceZ zone, set the CPU Units option of this Compute resource1 to 2000. For example, giving Compute resource 1 a score of 1000 and Compute resource 2 the score of 500 is the same as giving Compute resource 1 a score of 2 and Compute resource 2 a score of 1. <span>However, the first case gives you more flexibility in spreading the resources between VMs.</span></p></div></div><p>When setting CPU units, t<span>he main thing is that the correlation between the CPU Units for each compute resource should correspond to the correlation of their actual performance.</span><span> </span>Example of setting CPU units based on CPU speed: </p><div class="table-wrap"><table class="wrapped confluenceTable"><colgroup><col/><col/><col/></colgroup><tbody><tr><td class="confluenceTd"><p>Compute Resource </p></td><td class="confluenceTd"><p>Compute Resource CPU Mhz </p></td><td class="confluenceTd"><p>Compute Resource Units </p></td></tr><tr><td class="confluenceTd"><p>A </p></td><td class="confluenceTd"><p>4000 </p></td><td class="confluenceTd"><p>1000 </p></td></tr><tr><td class="confluenceTd"><p>B </p></td><td class="confluenceTd"><p>2000 </p></td><td class="confluenceTd"><p>500 </p></td></tr><tr><td class="confluenceTd"><p>C </p></td><td class="confluenceTd"><p>1000 </p></td><td class="confluenceTd"><p>250 </p></td></tr><tr><td class="confluenceTd"><p>D </p></td><td class="confluenceTd"><p>500 </p></td><td class="confluenceTd"><p>125 </p></td></tr></tbody></table></div><div class="confluence-information-macro confluence-information-macro-note"><p class="title">Limitations</p><span class="aui-icon aui-icon-small aui-iconfont-warning confluence-information-macro-icon"></span><div class="confluence-information-macro-body"><ul><li>CPU Units are available for KVM compute resources only.</li><li>So far only billing calculations can be performed based on CPU units. Currently, we do not guarantee the same performance for VMs when migrating to another compute resource with a different capacity.</li></ul></div></div><hr/><p><br/></p>
                    </div>

                                                            <div class="pageSection group">
                        <div class="pageSectionHeader">
                            <h2 id="attachments" class="pageSectionTitle">Attachments:</h2>
                        </div>

                        <div class="greybox" align="left">
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/195792033/195792035.png">missing_period2.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/195792033/195793588.png">IPs.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/195792033/195793591.png">portspeed.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/195792033/195793594.png">miniops.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/195792033/195793596.png">disksize.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/195792033/195793599.png">cdc.PNG</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/195792033/195792036.png">IPs.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/195792033/195793603.png">portspeed.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/195792033/195792038.png">miniops.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/195792033/195793606.png">disksize.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/195792033/195792040.png">cdc.PNG</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/195792033/195792037.png">portspeed.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/195792033/195792039.png">disksize.png</a> (image/png)
                                <br/>
                                                    </div>
                    </div>
                    
                                                      
                </div>             </div> 
            <div id="footer" role="contentinfo">
                <section class="footer-body">
                    <p>Document generated by Confluence on May 07, 2024 09:23</p>
                    <div id="footer-logo"><a href="https://www.atlassian.com/">Atlassian</a></div>
                </section>
            </div>
        </div>     </body>
</html>
