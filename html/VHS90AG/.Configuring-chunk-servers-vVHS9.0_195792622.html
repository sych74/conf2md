<!DOCTYPE html>
<html>
    <head>
        <title>Virtuozzo Hybrid Server 9.0 Admin Guide : .Configuring chunk servers vVHS9.0</title>
        <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>

    <body class="theme-default aui-theme-default">
        <div id="page">
            <div id="main" class="aui-page-panel">
                <div id="main-header">
                    <div id="breadcrumb-section">
                        <ol id="breadcrumbs">
                            <li class="first">
                                <span><a href="index.html">Virtuozzo Hybrid Server 9.0 Admin Guide</a></span>
                            </li>
                                                    <li>
                                <span><a href="Virtuozzo-Hybrid-Server-9.0-Admin-Guide_195791490.html">Virtuozzo Hybrid Server 9.0 Admin Guide</a></span>
                            </li>
                                                    <li>
                                <span><a href="Virtuozzo-Storage-Administration_195792531.html">Virtuozzo Storage Administration</a></span>
                            </li>
                                                    <li>
                                <span><a href="195792599.html">Configuring Virtuozzo Storage Clusters¶</a></span>
                            </li>
                                                    <li>
                                <span><a href="Configuring-Chunk-Servers_195792623.html">Configuring Chunk Servers</a></span>
                            </li>
                                                </ol>
                    </div>
                    <h1 id="title-heading" class="pagetitle">
                                                <span id="title-text">
                            Virtuozzo Hybrid Server 9.0 Admin Guide : .Configuring chunk servers vVHS9.0
                        </span>
                    </h1>
                </div>

                <div id="content" class="view">
                    <div class="page-metadata">
                        
        
    
    
        
    
        
        
            Created by <span class='author'> Roksoliana Ben</span>, last modified on May 07, 2024
                        </div>
                    <div id="main-content" class="wiki-content group">
                    <div class="contentLayout2">
<div class="columnLayout single" data-layout="single">
<div class="cell normal" data-type="normal">
<div class="innerCell">
<p>This section explains how to complete the following tasks:</p><ul class="simple"><li><p>Increase disk space in a cluster by adding new chunk servers to it.</p></li><li><p>Remove chunk servers from a cluster to perform maintenance tasks on them.</p></li></ul></div>
</div>
</div>
<div class="columnLayout single" data-layout="single">
<div class="cell normal" data-type="normal">
<div class="innerCell">
<h2 id="id-.ConfiguringchunkserversvVHS9.0-AddingNewChunkServerstoIncreaseDiskSpace">Adding New Chunk Servers to Increase Disk Space</h2><hr/></div>
</div>
</div>
<div class="columnLayout single" data-layout="single">
<div class="cell normal" data-type="normal">
<div class="innerCell">
<p><span style="color: rgb(0,0,0);">You can increase the amount of disk space in a Virtuozzo Storage cluster simply by adding new chunk servers. For details, see<span> </span></span><a href=".Setting-up-chunk-servers-vVHS9.0_195792577.html"><span class="std std-ref">Setting Up Chunk Servers</span></a><span style="color: rgb(0,0,0);">.</span></p><div class="confluence-information-macro confluence-information-macro-note"><span class="aui-icon aui-icon-small aui-iconfont-warning confluence-information-macro-icon"></span><div class="confluence-information-macro-body"><p><span style="color: rgb(0,0,0);">You can increase the amount of disk space in a Virtuozzo Storage cluster simply by adding new chunk servers. For details, see<span> </span></span><a href=".Setting-up-chunk-servers-vVHS9.0_195792577.html"><span class="std std-ref">Setting Up Chunk Servers</span></a><span style="color: rgb(0,0,0);">.</span></p></div></div></div>
</div>
</div>
<div class="columnLayout single" data-layout="single">
<div class="cell normal" data-type="normal">
<div class="innerCell">
<h2 id="id-.ConfiguringchunkserversvVHS9.0-RemovingChunkServers">Removing Chunk Servers</h2></div>
</div>
</div>
<div class="columnLayout single" data-layout="single">
<div class="cell normal" data-type="normal">
<div class="innerCell">
<p><span style="color: rgb(0,0,0);">If you need to remove a chunk server from the cluster, for example, to perform some maintenance tasks on it, do the following:</span></p><ol><li><span style="color: rgb(0,0,0);">Ensure that:<br/></span><ul><li><p>The number of chunk servers configured for your cluster is enough to store the required number of data chunks (<span>i.e.</span>, equals or exceeds the current replication value).</p></li><li><p>The chunk servers have enough disk space to store the chunks. For instructions on obtaining this information, see<span> </span><a href=".Monitoring-chunk-servers-vVHS9.0_195792700.html"><span class="std std-ref">Monitoring Chunk Servers</span></a>.</p></li></ul></li><li><p><span style="color: rgb(0,0,0);">Find out the index number of the chunk server you want to remove by running the following command on some of your cluster servers:*<br/></span></p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence"># vstorage -c stor1 top</pre>
</div></div><p><span style="color: rgb(0,0,0);">It will display detailed information about the<span> </span><code class="docutils literal notranslate" style="text-align: left;"><span class="pre">stor1</span></code><span> </span>cluster. Locate the section with the details about chunk servers, for example:<br/></span></p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">...
 CSID  STATUS     SPACE   FREE REPLICAS IOWAIT IOLAT(ms) QDEPTH HOST
 1025  active     105GB   88GB       40     0%       0/0    0.0 10.30.17.38
 1026  active     105GB   88GB       40     0%       0/0    0.0 10.30.18.40
 1027  active     105GB   99GB       40     0%       0/0    0.0 10.30.21.30
 1028  active     107GB  101GB       40     0%       0/0    0.0 10.30.16.38
...</pre>
</div></div><p><span style="color: rgb(0,0,0);">The<span> </span><strong style="text-align: left;">CSID</strong><span> </span>column displays the index number of chunk servers. In the output above, four chunk servers are configured for the<span> </span><code class="docutils literal notranslate" style="text-align: left;"><span class="pre">stor1</span></code><span> </span>cluster. They have index numbers of 1025, 1026, 1027, and 1028.<br/></span></p></li><li><p><span style="color: rgb(0,0,0);">Remove the chunk server from the cluster. For example, to delete the chunk server with index number 1028 from the<span> </span><code class="docutils literal notranslate" style="text-align: left;"><span class="pre">stor1</span></code><span> </span>cluster, run this command:<br/></span></p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence"># vstorage -c stor1 rm-cs --wait 1028</pre>
</div></div></li></ol><p>Once you initiate the delete operation, the cluster starts replicating data chunks stored on the removed server and placing them on the remaining chunk servers of the cluster. The<span> </span><code class="docutils literal notranslate"><span class="pre">--wait</span></code><span> </span>option, when specified, tells the command to wait until the operation is complete (which may take a long time).</p><p>Note the following:</p><ul class="simple"><li><p>If the CS’s disk has disappeared from the OS and the CS has no access to its repository, data chunks that need to be replicated will not be accessible, and CS removal will not be complete. You must forcibly remove the CS from the cluster with the<span> </span><code class="docutils literal notranslate"><span class="pre">-f</span></code><span> </span>option.<span> </span><strong>Warning:</strong><span> </span>Do so only if the CS is irreversibly lost. Never remove active chunk servers with the<span> </span><code class="docutils literal notranslate"><span class="pre">-f</span></code><span> </span>option.</p></li><li><p>When deletion is in progress, you can cancel it with the command<span> </span><code class="docutils literal notranslate"><span class="pre">vstorage</span><span> </span><span class="pre">-c</span><span> </span><span class="pre">stor1</span><span> </span><span class="pre">rm-cs</span><span> </span><span class="pre">--cancel</span><span> </span><span class="pre">1028</span></code>. It might be useful, for example, if you specified a wrong ID of the chunk server to remove.</p></li></ul><p><span style="color: rgb(0,0,0);">To add a removed chunk server back to the cluster, set it up from scratch by following the steps in<span> </span></span><a href=".Setting-up-chunk-servers-vVHS9.0_195792577.html"><span class="std std-ref">Setting Up Chunk Servers</span></a><span style="color: rgb(0,0,0);">.</span></p></div>
</div>
</div>
</div>
                    </div>

                                        
                                                      
                </div>             </div> 
            <div id="footer" role="contentinfo">
                <section class="footer-body">
                    <p>Document generated by Confluence on May 07, 2024 09:23</p>
                    <div id="footer-logo"><a href="https://www.atlassian.com/">Atlassian</a></div>
                </section>
            </div>
        </div>     </body>
</html>
