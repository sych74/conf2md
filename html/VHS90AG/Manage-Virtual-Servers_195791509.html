<!DOCTYPE html>
<html>
    <head>
        <title>Virtuozzo Hybrid Server 9.0 Admin Guide : Manage Virtual Servers</title>
        <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>

    <body class="theme-default aui-theme-default">
        <div id="page">
            <div id="main" class="aui-page-panel">
                <div id="main-header">
                    <div id="breadcrumb-section">
                        <ol id="breadcrumbs">
                            <li class="first">
                                <span><a href="index.html">Virtuozzo Hybrid Server 9.0 Admin Guide</a></span>
                            </li>
                                                    <li>
                                <span><a href="Virtuozzo-Hybrid-Server-9.0-Admin-Guide_195791490.html">Virtuozzo Hybrid Server 9.0 Admin Guide</a></span>
                            </li>
                                                    <li>
                                <span><a href="Control-Panel-Administration_195792528.html">Control Panel Administration</a></span>
                            </li>
                                                    <li>
                                <span><a href="Virtual-Servers_195791495.html">Virtual Servers</a></span>
                            </li>
                                                </ol>
                    </div>
                    <h1 id="title-heading" class="pagetitle">
                                                <span id="title-text">
                            Virtuozzo Hybrid Server 9.0 Admin Guide : Manage Virtual Servers
                        </span>
                    </h1>
                </div>

                <div id="content" class="view">
                    <div class="page-metadata">
                        
        
    
    
        
    
        
        
            Created by <span class='author'> Roksoliana Ben</span>, last modified on Apr 17, 2024
                        </div>
                    <div id="main-content" class="wiki-content group">
                    <div class="contentLayout2">
<div class="columnLayout single" data-layout="single">
<div class="cell normal" data-type="normal">
<div class="innerCell">
<p>Virtual servers are based on templates and are deployed on сompute resources. Compute resources give them access to CPU, disk, and network resources. OnApp supports two kinds of storage for virtual servers: traditional centralized SANs and the new distributed block storage functionality introduced with OnApp Storage, in which local disks in сompute resources provide the physical storage space allocated to virtual servers. In each case, the OnApp platform creates virtual data stores from the physical resources and uses these to provide virtual servers with virtual disks. This document provides information on how you can manage virtual servers in your OnApp сloud. </p><div class="confluence-information-macro confluence-information-macro-note"><span class="aui-icon aui-icon-small aui-iconfont-warning confluence-information-macro-icon"></span><div class="confluence-information-macro-body"><p>Ignore the options specified in your Control Panel but not mentioned in the documents.</p></div></div><hr/><h2 class="with-breadcrumbs" id="ManageVirtualServers-viewViewVirtualServers"><span class="confluence-anchor-link" id="ManageVirtualServers-view"></span>View Virtual Servers</h2></div>
</div>
</div>
<div class="columnLayout single" data-layout="single">
<div class="cell normal" data-type="normal">
<div class="innerCell">
<ol><li><span>Go to your Control Panel &gt; </span><strong>Cloud</strong><span> &gt;</span><strong> Virtual Servers </strong><span>menu to see an overview of all virtual servers in the cloud.</span></li><li><span>The page that loads will show the list of VSs together with their: </span></li><ul><li><span>Operating system</span></li><li><span>Label - click to see the VS details.</span></li><li><span>VIP status - click the icon to enable/disable the VIP status of a particular VS.</span></li><li><span>IP addresses</span></li><li><span>Allocated disk size</span></li><li><span>RAM</span></li><li><span>Backups - the number of backups and the space these backups take.</span></li><li><span>Compute resource - the label of compute resource with which VS is associated.</span></li><li><span>User - the owner of this VS. Click the user name to see the owner details.</span></li><li><span>CPU(s) - the number of CPU(s) included.</span></li><li><span style="color: rgb(255,0,0);"><span style="color: rgb(51,51,51);">Guest Tools - shows if the guest tools are installed and started. For more information about guest tools, refer to the</span> <a href="https://docs.onapp.com/display/VHS9AG/Managing+Guest+Tools">Managing Guest Tools</a> <span style="color: rgb(51,51,51);">section.</span></span></li><li><span>Power status - click the on/off buttons to change the status.</span></li></ul><li><span>Click the </span><strong>Actions</strong><span> button next to the VS for quick access to the list of VS actions (the list of actions displayed depends on the VS status):</span></li></ol><ul><li><span>Recovery reboot</span></li><li><span>Power off a VS</span></li><li><span>CPU usage</span></li><li><span>Backups</span></li><li><span>Shutdown</span></li><li><span>Startup</span></li><li><span>Recovery start up</span></li><li><span>Unlock</span></li><li><span style="color: rgb(51,51,51);">Console</span></li></ul><p>If you are viewing the VSs list on a narrow screen, you can customize the way the table is displayed by clicking the actions icon at the top of the table. In the drop-down list that appears, check the columns you want to be displayed and click <strong>Apply</strong>. The narrower your screen is, the more unchecked columns will be hidden from the table. If your screen is too narrow to fit all the columns you have checked, a scrollbar will appear at the bottom of the VSs list. You can always alter your column selection later. Note that by default the VIP and Backups columns are not visible in the table on narrow screens.</p><div class="confluence-information-macro confluence-information-macro-information"><span class="aui-icon aui-icon-small aui-iconfont-info confluence-information-macro-icon"></span><div class="confluence-information-macro-body"><p>Column selection is currently set for one browser. If you have checked some columns in one browser and opened the list in some other browser, the column selection will be the default one for that other browser.</p></div></div><p><span>To search for a particular virtual server, click the <strong>Search</strong> icon at the top of the VS list. When the search box appears, type the text you want to search for and click the <strong>Search</strong> button.</span></p></div>
</div>
</div>
<div class="columnLayout single" data-layout="single">
<div class="cell normal" data-type="normal">
<div class="innerCell">
<hr/><h2 class="with-breadcrumbs" id="ManageVirtualServers-view-detailsViewVirtualServerDetails"><span class="confluence-anchor-link" id="ManageVirtualServers-view-details"></span>View Virtual Server Details</h2></div>
</div>
</div>
<div class="columnLayout single" data-layout="single">
<div class="cell normal" data-type="normal">
<div class="innerCell">
<p><br/></p><ol><li>Go to your Control Panel &gt; <strong>Cloud</strong> &gt; <strong>Virtual Servers </strong>menu.</li><li>Click the label of the virtual server you're interested in.</li><li>The screen that appears loads the <span class="confluence-link"><a href="#ManageVirtualServers-vs_properties">VS properties</a></span>, <a href="#ManageVirtualServers-notes">notes</a>, <span class="confluence-link">activity log,</span> and <a href="#ManageVirtualServers-vs_management">tools for managing</a> your VS.</li></ol><h3 id="ManageVirtualServers-vs_propertiesVSProperties"><span class="confluence-anchor-link" id="ManageVirtualServers-vs_properties"></span>VS Properties</h3><p>The VS properties page gives a general overview of the VS details:</p><ul><li><span> <span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image confluence-thumbnail" draggable="false" width="30" src="attachments/195791509/195791512.png" data-image-src="attachments/195791509/195791512.png" data-unresolved-comment-count="0" data-linked-resource-id="195791512" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="image2021-4-7_16-34-16.png" data-base-url="https://docs.onapp.com" data-linked-resource-content-type="image/png" data-linked-resource-container-id="195791509" data-linked-resource-container-version="8" alt=""></span>- VIP status, click the icon to change the status.</span></li><li><span>Template this VS is built on.</span></li><li><strong>ON</strong><span>, </span><strong>OFF</strong><span>, and </span><strong>REBOOT</strong><span> buttons - the greened-out button indicates VS's power status.</span></li></ul><div class="confluence-information-macro confluence-information-macro-note"><span class="aui-icon aui-icon-small aui-iconfont-warning confluence-information-macro-icon"></span><div class="confluence-information-macro-body"><p><span>Clicking the OFF button performs a graceful shutdown and then powers off the virtual server after the timeout is set in </span><a href="https://docs.onapp.com/display/VHS9AG/Configuration+Settings"><span>configuration settings</span></a><span>.</span></p></div></div><ul><li><p><em><span>Auto-backups</span></em><span> - move the slider to enable/disable automatic backups for this VS. </span></p><div class="confluence-information-macro confluence-information-macro-note"><span class="aui-icon aui-icon-small aui-iconfont-warning confluence-information-macro-icon"></span><div class="confluence-information-macro-body"><p><span>If the automation options weren’t enabled during this virtual server creation, you’ll be redirected to the form where you can configure them.</span></p></div></div></li></ul><ul><li><span style="color: rgb(255,0,0);"><span style="color: rgb(51,51,51);"><em>Guest Tools</em> - shows if the guest tools are installed and started. For more information about guest tools, refer to the</span> <a href="https://docs.onapp.com/display/VHS9AG/Managing+Guest+Tools">Managing Guest Tools</a> <span style="color: rgb(51,51,51);">section. </span></span></li><li><em><span>FQDN</span></em><span> - fully qualified domain name.</span></li><li><em><span>Compute Resource</span></em><span> - click the compute resource name to see its details.</span></li><li><em><span>Login</span></em><span> - </span><span>credentials for this VS. <span style="color: rgb(51,51,51);">You<span style="color: rgb(255,0,0);"><span style="color: rgb(51,51,51);"> can copy the root password to the clipboard with</span> <span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image confluence-thumbnail" draggable="false" width="26" src="attachments/195791509/195791513.png" data-image-src="attachments/195791509/195791513.png" data-unresolved-comment-count="0" data-linked-resource-id="195791513" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="image2022-5-6_14-20-35.png" data-base-url="https://docs.onapp.com" data-linked-resource-content-type="image/png" data-linked-resource-container-id="195791509" data-linked-resource-container-version="8" alt=""></span></span>.</span></span></li><li><em><span>Owner</span></em><span> - owner of the VS, click to see the details.</span></li><li><em><span>IP Addresses</span></em><span>. Only the first five IP addresses are displayed on the virtual server properties page. To view the list of all virtual server IP addresses, mouse over the IP addresses area or go to the </span><strong>Networking </strong><span>&gt; </span><strong>IP addresses</strong><span> tab. To view external IP addresses, you have to add them via API call first. To add an external IP address, refer to the </span><a href="https://docs.onapp.com/apim/latest/ip-addresses/external-ip-addresses/add-edit-external-ip-address" rel="nofollow"><span>Add/Edit External IP Address</span></a><span> section of the API Guide. Once you've added an IP address, you can view it after the </span><strong>-&gt;</strong><span> sign. For example, </span><span>7.7.0.17 -&gt; 8.8.8.7</span></li><li><em><span>Estimated Price per hour</span></em><span> - this sum does not take into consideration the free limits for resources set in the bucket. Therefore, the final price for the server might differ from the sum indicated here.</span></li><li><em><span>CPU(s)</span></em></li><li><em><span>CPU priority or CPU units</span></em></li><li><em><span>Disk Size</span></em><span> - the total amount of disk size</span></li><li><em><span>Memory</span></em></li><li><em><span>Disk backups</span></em><span> - the total amount of backups</span></li><li><span>CPU usage chart</span></li><li><span>Network usage (data sent and data received in GB per hour) chart</span></li></ul></div>
</div>
</div>
<div class="columnLayout single" data-layout="single">
<div class="cell normal" data-type="normal">
<div class="innerCell">
<h3 id="ManageVirtualServers-notesNotes"><span class="confluence-anchor-link" id="ManageVirtualServers-notes"></span>Notes</h3><p>The Notes section lists brief comments or reminders for a VS. You can add either Admin's or User's notes. The Admin's note will be available to cloud administrators.</p><p><span class="confluence-anchor-link" id="ManageVirtualServers-vs_management"></span><span>VS Management</span></p><ul><li><span>Click </span><strong>Actions</strong><span> to see the menu with the VS management options.</span></li><li>Use the top menu to manage your virtual servers' <a href="https://docs.onapp.com/display/VHS9AG/Manage+Virtual+Server+Statistics">statistics</a>/<a href="https://docs.onapp.com/display/VHS9AG/Manage+Virtual+Server+Networks">networking</a>/<a href="https://docs.onapp.com/display/VHS9AG/Manage+Virtual+Server+Disks">storage</a> options.</li></ul></div>
</div>
</div>
<div class="columnLayout single" data-layout="single">
<div class="cell normal" data-type="normal">
<div class="innerCell">
<hr/><h2 id="ManageVirtualServers-rebuildRebuild/BuildVirtualServerManually"><span class="confluence-anchor-link" id="ManageVirtualServers-rebuild"></span>Rebuild/Build Virtual Server Manually</h2></div>
</div>
</div>
<div class="columnLayout single" data-layout="single">
<div class="cell normal" data-type="normal">
<div class="innerCell">
<div class="confluence-information-macro confluence-information-macro-note"><span class="aui-icon aui-icon-small aui-iconfont-warning confluence-information-macro-icon"></span><div class="confluence-information-macro-body"><p>To build/rebuild virtual server <em>Build/rebuild virtual server</em> and <em>Manage public templates</em> <a href="https://docs.onapp.com/display/VHS9AG/OnApp+Permissions">permissions</a> must be enabled.</p></div></div><p>If you haven't checked the <strong>Build Virtual Server</strong> option during the VS <a href="https://docs.onapp.com/display/VHS9AG/Create+Virtual+Server">creation process</a>, you will have to do this manually after the VS has been created. Building a virtual server is the process of allocating physical resources to that VS.</p><p><br/>To build a virtual server manually or rebuild the VS on the same (or another) template:</p><ol><li>Go to your Control Panel &gt; <strong>Cloud</strong> &gt; <strong>Virtual Servers</strong> menu.</li><li>Click the label of the virtual server you're interested in.</li><li>On the screen that appears, click the <strong>Actions </strong>button, point to <strong>Options</strong>, and then click <strong>Rebuild Virtual Server.</strong></li><li><p>On the screen that pops up, use the drop-down menu to choose a template with which to build the VS.</p><div class="confluence-information-macro confluence-information-macro-information"><span class="aui-icon aui-icon-small aui-iconfont-info confluence-information-macro-icon"></span><div class="confluence-information-macro-body"><p>It is not possible to rebuild a Linux-based virtual server to FreeBSD templates.</p><p>It is not possible to rebuild a Windows-based virtual server to Linux/FreeBSD template and vice versa.</p></div></div></li><li>Move the <strong>Start VS after rebuild </strong>slider to the right if you want to have your VS started automatically after it is built.</li><li>Select the following options if you selected Windows<br/><strong>Windows</strong><ul><li><strong>Windows Licensing type</strong> - KMS, MAK, or OWN.</li><li><strong>Licensing key</strong> - input license if you selected OWN licensing type.</li><li>Select <strong>Server</strong> for KMS licensing type.</li></ul></li><li>Click the <strong>Rebuild Virtual Server</strong> button to finish.</li></ol></div>
</div>
</div>
<div class="columnLayout single" data-layout="single">
<div class="cell normal" data-type="normal">
<div class="innerCell">
<div class="confluence-information-macro confluence-information-macro-note"><span class="aui-icon aui-icon-small aui-iconfont-warning confluence-information-macro-icon"></span><div class="confluence-information-macro-body"><ul><li>To successfully rebuild the VS, you have to approve this transaction as an administrator. To approve the transaction, go to <strong>Dashboard</strong> &gt; <strong>Logs</strong> menu and click the <strong>Approve</strong> button.</li><li>After you rebuild your template all data will be lost.</li><li>If the VS was built from a template with system service add-ons assigned, all added system service add-ons will be removed from the VS after the rebuild. </li></ul></div></div></div>
</div>
</div>
<div class="columnLayout single" data-layout="single">
<div class="cell normal" data-type="normal">
<div class="innerCell">
<hr/><h2 class="with-breadcrumbs" id="ManageVirtualServers-edit-vsEditVirtualServer"><span class="confluence-anchor-link" id="ManageVirtualServers-edit-vs"></span>Edit Virtual Server</h2></div>
</div>
</div>
<div class="columnLayout single" data-layout="single">
<div class="cell normal" data-type="normal">
<div class="innerCell">
<p>You can edit resources for all VSs. Depending on the template it is built on, some VSs can have their CPU or RAM or both resized without needing to be powered off (&quot;resize without reboot&quot;). If the VS template allows resizing of the required resource without the reboot, the resize should be completed automatically: you will be returned to the VS details screen and see a message indicating the resize was successful. If the template does not allow this, you will be asked to confirm that the VS will need rebooting so that the resize can take place. </p><div class="confluence-information-macro confluence-information-macro-note"><span class="aui-icon aui-icon-small aui-iconfont-warning confluence-information-macro-icon"></span><div class="confluence-information-macro-body"><ul><li>Windows virtual servers cannot be resized without a reboot.</li><li>It is not possible to increase the VS RAM beyond its <code>max_memory</code> value without rebooting the server.</li><li>If the template on which the VS is built has the value 'YES' for the resize without reboot option, it might denote that either CPU or RAM can be changed without rebooting the server. Some templates support the resize without reboot only for either CPU or RAM while in other templates both CPU and RAM can be changed without rebooting the server. The virtualization type also influences the resize without reboot option.</li></ul></div></div><p>To adjust VS resources:</p><ol><li>Go to your Control Panel &gt; <strong>Cloud</strong> &gt; <strong>Virtual Servers</strong> menu.</li><li>Click the label of the server you want to resize, to show its details screen.</li><li>Click the<strong> Actions </strong>button, point to <strong>Options</strong>, and select the <strong>Edit Virtual Server</strong> link.<p><em>For virtual servers built by selecting resources manually:</em><br/><br/></p><ul><li><p class="auto-cursor-target">Change CPU cores, CPU priority/units, and RAM values.</p></li></ul><em>For VSs based on KVM compute resources only, providing the Enable CPU topology permission is switched on for the user:</em></li></ol><ul><li style="list-style-type: none;background-image: none;"><ul><li>Change the number of CPU sockets.<br/><br/></li></ul></li></ul><div class="confluence-information-macro confluence-information-macro-information"><p class="title">Setting the correct amount of CPU sockets</p><span class="aui-icon aui-icon-small aui-iconfont-info confluence-information-macro-icon"></span><div class="confluence-information-macro-body"><ul><li style="list-style-type: none;background-image: none;"><ul><li class="_mce_tagged_br"><span>Set the total amount of virtualized CPUs and the number of sockets. </span></li><li class="_mce_tagged_br"><span>The value of <code>cores_per_socket </code>will be calculated automatically by the formula vCPUs  = <code>cpu_sockets</code> x <code>cores_per_socket</code>. </span></li><li class="_mce_tagged_br"><span>Thus, if you set the vCPU value to <code>8</code>, and the CPU sockets to <code>2</code>, this means that the <code>cores_per_socket</code> value will be set to<code> 4</code>.</span></li></ul></li></ul></div></div><p style="margin-left: 30.0px;">You can also edit the <em>Time Zone</em> parameter for all Windows KVM virtual servers. After you edit the server's time zone, you need to stop and then start up the VS. Currently, the time zone is set at the compute resource side only. Therefore, users need to set the target time zone inside a Windows VS manually. Setting the correct time zone at the compute resource side helps to keep correct time inside a VS after starting it if time synchronization is not completed for some reason.</p><p style="margin-left: 30.0px;">After changing VS resources you can see two prices per this VS per hour, depending on VS power status (on/off).</p><ul><li style="list-style-type: none;background-image: none;"><ul><li>Click the <strong>Save </strong>button.</li></ul></li></ul></div>
</div>
</div>
<div class="columnLayout single" data-layout="single">
<div class="cell normal" data-type="normal">
<div class="innerCell">
<hr/><h2 id="ManageVirtualServers-cloneCloneVirtualServer"><span class="confluence-anchor-link" id="ManageVirtualServers-clone"></span>Clone Virtual Server</h2></div>
</div>
</div>
<div class="columnLayout single" data-layout="single">
<div class="cell normal" data-type="normal">
<div class="innerCell">
<p><span>You can create a clone based on the same resources as the origin virtual server. The cloned virtual server inherits resources from the origin as follows. </span></p><div class="table-wrap"><table class="relative-table wrapped confluenceTable" style="width: 75.0663%;"><colgroup><col style="width: 34.6596%;"/><col style="width: 65.3404%;"/></colgroup><tbody><tr><th class="confluenceTh">Resource</th><th class="confluenceTh"><span>Cloned Virtual Server</span></th></tr><tr><td colspan="1" class="confluenceTd"><p>Owner</p></td><td colspan="1" class="confluenceTd"><span>The same as the origin virtual server.</span></td></tr><tr><td class="confluenceTd"><p>Properties: <span>hostname, password, and label</span></p></td><td class="confluenceTd"><p><span>You can change the properties while cloning a KVM VS. By default if you clone a virtual server without changing the values of the hostname, password, and label:</span></p><ul><li><span>The hostname remains the same as it is in the origin virtual server.</span></li><li><span>The password acquires random values.</span></li><li><span>The label is the same as the origin virtual server's label but with <em>Clone</em> in the label. For example, <em>Clone Origin Label</em>.</span></li></ul></td></tr><tr><td class="confluenceTd"><ul><li>Compute, data store, and network resources &amp; zones</li><li><span>Firewall rules<br/></span></li></ul></td><td class="confluenceTd"><p><span>The same as the origin virtual server. <br/></span>If there are no available resources on the same data store, network, and compute resource, you cannot clone a virtual server. </p></td></tr><tr><td class="confluenceTd"><p>IP address</p></td><td class="confluenceTd"><p>A random IP address is assigned from an IP range in the origin network. After a virtual server is cloned and before you start it, you should <a href="https://docs.onapp.com/pages/viewpage.action?pageId=194478894">assign a new IP address</a>.</p></td></tr><tr><td class="confluenceTd">Swap disk</td><td class="confluenceTd">A new swap disk is created on the cloned virtual server.</td></tr><tr><td colspan="1" class="confluenceTd"><p><span>Backups</span></p></td><td colspan="1" class="confluenceTd"><span>The backups of the origin virtual server are not cloned. </span></td></tr></tbody></table></div><p><br/>To clone a virtual server, follow the next procedure:</p><ol><li>Go to your Control Panel &gt; <strong>Cloud</strong> &gt; <strong>Virtual Servers</strong>.</li><li>Click a label of the virtual server that you want to clone.</li><li>Click <strong>Actions</strong>, point to<strong> Options</strong>,<strong> </strong>and click <strong>Clone Virtual Server</strong>. </li><li>In the dialog box, you can change the properties if required:<ul><li><em>Label</em> </li><li><p><em>Hostname</em> - a hostname of the virtual server. The hostname can consist of letters [A-Z a-z], digits [0-9], and a dash [ - ]. For more info on hostname validation, refer to <a style="text-decoration: none;" class="external-link" rel="nofollow" href="http://www.faqs.org/rfcs/rfc1123.html">RFC documentation</a>.</p><div id="expander-259009340" class="expand-container"><div id="expander-control-259009340" class="expand-control" aria-expanded="true"><span class="expand-icon aui-icon aui-icon-small aui-iconfont-chevron-down"></span><span class="expand-control-text">Additional Consideration for Windows</span></div><div id="expander-content-259009340" class="expand-content"><p>The following symbols are not allowed for Windows-based virtual servers:</p><ul><li>Percent  [%]</li><li>Quotation marks [“ “]</li><li>Angle brackets [&lt;&gt;]</li><li>Vertical bar [ | ]</li><li>Caret [^]</li><li>Ampersand [&amp;]</li><li>Parentheses [( )]</li></ul></div></div><ul><li><p><em>Password</em> - password for the virtual server. It can consist of 6-99 symbols, including letters [A-Z a-z], digits [0-9], dash [ - ], underscore [ _ ], and the following special characters:<span> </span>~ ! @ # $ * _ - + = ` \\ { } [ ] : ; ' , . ? /<span>. </span>You can use both lower and uppercase letters. If you don't enter a password, it will be generated automatically.</p></li><li><em>Password confirmation</em> - repeat the password to confirm it.</li><li><p><em>Encrypt password</em> - move the slider to the right to encrypt your password.</p></li></ul></li></ul></li><li>Click <strong>Clone Virtual Server </strong>to confirm the action. </li></ol><p>After you confirm the action, several transactions are run to complete the cloning process. You can check the status of each transaction in the <a href="https://docs.onapp.com/display/VHS9AG/Logs">Activity Log</a> of the virtual server. After the virtual server is cloned, it is powered off until you <a href="https://docs.onapp.com/display/VHS9AG/Manage+Virtual+Server+Power+Options">start it</a>. </p></div>
</div>
</div>
<div class="columnLayout single" data-layout="single">
<div class="cell normal" data-type="normal">
<div class="innerCell">
<hr/><h2 id="ManageVirtualServers-migrateMigrateVirtualServer"><span class="confluence-anchor-link" id="ManageVirtualServers-migrate"></span>Migrate Virtual Server</h2></div>
</div>
</div>
<div class="columnLayout single" data-layout="single">
<div class="cell normal" data-type="normal">
<div class="innerCell">
<p>You can migrate virtual servers using a <em>hot</em> or <em>cold</em> migration method:</p><ul><li><strong><a href="#ManageVirtualServers-1">Hot migration</a></strong> is a live migration of a virtual server without disks and NICs between compute resources that share common data stores or data store zones.</li><li><strong><a href="#ManageVirtualServers-2">Cold migration</a></strong> is a migration of virtual servers with disks between compute resources with local storage or across compute zones.</li></ul><p>As an Admin, you can control user access to virtual server migration. Using <a href="https://docs.onapp.com/display/VHS9AG/OnApp+Permissions">OnApp permissions</a>, you can allow/forbid users to perform migration of all virtual servers or their own servers. This is handled via the Control Panel &gt; <strong>Roles </strong>menu.</p><hr/><h3 id="ManageVirtualServers-HotMigration"><strong>Hot Migration</strong></h3><p><span>You can migrate an online virtual server from one compute resource to another compute resource that is both utilizing local/shared/IS storage or across zones. </span></p><h4 id="ManageVirtualServers-1HotMigrationBetweenComputeResources"><span class="confluence-anchor-link" id="ManageVirtualServers-1"></span>Hot Migration Between Compute Resources</h4><p>Before you begin, take into consideration the following: </p><ul><li>Check if your Windows template supports hot migration at the <a href="http://templates.repo.onapp.com/Windows_templates.html" class="external-link" rel="nofollow">Windows Templates</a>.</li><li><span>Migrating a virtual server to a compute resource with <em>Any</em> operating system type has the next implications. </span><span>It won’t be possible to set the <em>Windows Only</em> type for a compute resource if there are any Linux or FreeBSD VSs residing on it. Likewise, it won't be possible to set the <em>Non Windows</em> type for a compute resource, if there are Windows-based VSs residing on it.</span></li><li>If both source and destination compute resources have backup IP addresses, VS migration will be performed using those backup IP addresses as an alternative network for traffic. If the migration fails for any reason, it will be retried using the destination compute resource IP address in the management network.</li></ul><h5 id="ManageVirtualServers-MigrateOneVirtualServer">Migrate One Virtual Server</h5><p>To hot migrate a virtual server:</p><ol><li>Go to your Control Panel &gt; <strong>Cloud</strong> &gt; <strong>Virtual Servers</strong>.</li><li>Click a label of a virtual server that you want to migrate.</li><li>Click the <strong>Actions </strong>button, point to <strong>Options</strong>, and click the <strong>Migrate Virtual Server</strong> button.</li><li>In the <strong>Migration Type</strong> box, select <em>Compute Resource </em>and click <strong>Next</strong>. </li><li>Select a <em>Target compute resource</em> from the box and click <strong>Next</strong>. </li><li>At the final step of the wizard, you can see the migration summary and select the following: <ul><li><em>Cold-migrate when hot-migration fails</em> - select the check box to apply cold migration in case of the hot migration failure.</li><li><span style="color: rgb(0,0,0);"><em>Auto-converge - </em>select the preferable type of auto-converge functionality: </span><ul><li><span style="color: rgb(0,0,0);"><em>Minor - </em>auto-converge with default CPU throttling during migration.</span></li><li><span style="color: rgb(0,0,0);"><em>Moderate - </em>auto-converge with moderate CPU throttling.</span></li><li><span style="color: rgb(0,0,0);"><em>Aggressive - </em>auto-converge with aggressive CPU throttling.</span></li></ul></li></ul></li></ol><div class="confluence-information-macro confluence-information-macro-information"><span class="aui-icon aui-icon-small aui-iconfont-info confluence-information-macro-icon"></span><div class="confluence-information-macro-body"><p><span style="color: rgb(0,0,0);"><em>Auto-converge </em>is only available for virtual servers based on KVM compute resources with CentOS 7 or higher. You can only select one type of <em>Auto-converge</em> at a time.</span></p></div></div><p>          7. When you are finished, click the<strong> Submit</strong> button.</p><h5 id="ManageVirtualServers-MigrateMultipleVirtualServers">Migrate Multiple Virtual Servers</h5><p>You can also migrate multiple virtual servers at once from one compute resource to another compute resource of the same type (KVM to KVM). The mass migration is available within compute resources that belong to the same compute zone. To migrate virtual servers, follow the next steps: </p><ol><li>In the <strong>Admin</strong> &gt; <strong>Compute Resources</strong> section, click a compute zone label to see the list of compute resources. </li><li>Click a label of a destination compute resource. On the screen that appears, you will see a list of all virtual servers hosted on the compute resource.</li><li><p>Select checkboxes next to the virtual servers that you want to migrate and click the <strong>Migrate</strong> button. <span>To select all virtual servers residing on the compute resource, click the first checkbox. To cancel the selection of all virtual servers, click this checkbox again.</span></p></li><li>In the pop-up box, select the following options:<br/><ul><li><em>Target compute resource</em> - select a destination compute resource to migrate the virtual servers to.</li><li><p class="_mce_tagged_br"><em>Cold-migrate when hot-migration fails</em> - select the checkbox if you want to apply cold migration in case of the hot migration failure.</p><div class="confluence-information-macro has-no-icon confluence-information-macro-note"><div class="confluence-information-macro-body"><p>If some of the selected virtual servers have disks that run as local storage on this compute resource, these virtual servers could not be migrated. After the migration, these virtual servers remain on the previous compute resource, while other VSs are migrated to the destination compute resource.</p></div></div></li></ul></li><li>When you are finished, click the <strong>Submit</strong> button. </li></ol><p>After migration, the power status of your virtual server remains the same as before the migration. If you migrate a virtual server that is running, the whole process is almost unnoticeable.</p><h3 id="ManageVirtualServers-2ColdMigration"><span class="confluence-anchor-link" id="ManageVirtualServers-2"></span><strong>Cold Migration</strong></h3><p><span>Cold migration enables you to migrate virtual servers with or without disks and NICs between compute resources with local storage or across compute zones. There are several prerequisites for the cold migration:</span></p><ul><li>You should shut down a virtual server before performing the migration.</li><li>You can cold migrate a virtual server NIC to a VXLAN/VLAN management network that is not shared by the source and destination compute resources. When you migrate a NIC to another network, only one IP address assigned to a virtual server is migrated. </li><li><p>The bandwidth from compute resource to compute resource should be sufficient enough to allow transferring of virtual servers.</p></li><li>Cold migration is applicable to virtual servers with local storage. Be aware that migration will take more time if you want to perform it between shared data stores.</li><li>Be aware that <a href="https://docs.onapp.com/display/VHS9AG/Manage+Virtual+Server+Disks">disk migration</a> is better than full VS migration in case you want to migrate the disks within the same compute zone and if the <a href="https://docs.onapp.com/display/VHS9AG/Backup+Servers+Settings">advanced backup scheme</a> is used. Such a scenario is applicable only to the shared data stores within the same compute zone.</li></ul><p>To cold migrate a virtual server with disks:</p><ol><li>Go to your Control Panel &gt; <strong>Cloud</strong> &gt; <strong>Virtual Servers</strong>.</li><li>Click a label of a virtual server that you want to migrate.</li><li>Click the <strong>Actions </strong>button, point to <strong>Options</strong>, and click the <strong>Migrate Virtual Server</strong> button.</li><li>In the <strong>Migration Type</strong> box, select <em>Full Migrate (Cold)</em>.</li><li>Select <em>Migrate Storage </em>and/or <em>Migrate Networks</em><span> and click <strong>Next</strong>. </span> </li><li>Select the destinations to which to migrate a virtual server:<br/><p><strong>Compute Resources<br/></strong></p><ul><li><em>Target compute zone</em> - select a destination compute zone.</li><li><em>Target compute resource - </em>select a destination compute resource.<br/>Click <strong>Next</strong><span> to proceed to the following step.</span></li></ul><p><strong>Storage Resources </strong></p><ul><li><em>Target data store for disk </em>- select a destination data store for each disk. The list includes available data stores associated with the compute zone and compute resource that you selected earlier.<br/>Click <strong>Next</strong><span> to proceed to the following step.</span></li></ul><p><strong>Network Resources<br/></strong></p><ul><li><em>Target network </em>- select a destination network for each network interface.</li><li><em>Target IP net - </em>select an IP net in a destination network .</li><li><em>Target IP range </em><em>- </em><span>select an IP range in a destination network.</span></li><li><em>Select and assign IP address </em>- <span>select an IP address to assign to a virtual server.  You can click <em>Free IPs</em> or <em>My IPs</em> to select from all free IP addresses or your own IP addresses. <br/>Click <strong>Next</strong> to proceed to the following step.<br/></span></li></ul></li><li>At the final step of the wizard, you can see the migration summary. Click<strong> Submit</strong> to start the migration<span>.</span></li></ol><div class="confluence-information-macro has-no-icon confluence-information-macro-information"><div class="confluence-information-macro-body"><ul><li><p class="p1"><span class="s1">You cannot migrate a virtual server from a compute resource that is offline. </span></p></li><li><p class="p1"><span class="s1">If you have local backups on source compute resources, please move them manually to a destination compute resource or backup server.<br/></span></p></li><li><p class="p1"><span class="s1">If you change the compute resource or data store zone, the billing will be changed according to the prices set for that new zone in the bucket.<span> The new estimated price per hour for a VS is displayed at the bottom of the VS migration screen.</span></span></p></li><li>Go to <strong>Admin</strong> &gt;<strong> Settings</strong> &gt; <strong>Configuration</strong> &gt; <strong>Defaults</strong> &gt; <em>Migration options,</em> if you want to set migration rate limit and limit of transactions which can be run simultaneously on the target compute resource when migrating a VS.</li></ul></div></div></div>
</div>
</div>
<div class="columnLayout single" data-layout="single">
<div class="cell normal" data-type="normal">
<div class="innerCell">
<hr/><h2 id="ManageVirtualServers-vip-statusSetVIPStatusforVirtualServer"><span class="confluence-anchor-link" id="ManageVirtualServers-vip-status"></span>Set VIP Status for Virtual Server</h2></div>
</div>
</div>
<div class="columnLayout single" data-layout="single">
<div class="cell normal" data-type="normal">
<div class="innerCell">
<p>If a compute resource fails or reboots, the system migrates virtual servers to another compute resource, one VS at a time. The order VSs are migrated is random. However, you can give a virtual server &quot;VIP&quot; status, and this will give that VS priority in the migration queue. <br/><br/>To set or remove VIP status for a VS:</p><ol><li>Go to your Control Panel &gt; <strong>Cloud</strong> &gt; <strong>Virtual Servers</strong> menu.</li><li>Use the icon in the <strong>VIP</strong> column next to a required virtual server to change the switch on/off the VIP status.</li></ol></div>
</div>
</div>
<div class="columnLayout single" data-layout="single">
<div class="cell normal" data-type="normal">
<div class="innerCell">
<hr/><h2 id="ManageVirtualServers-virshEnableVirshConsole"><span class="confluence-anchor-link" id="ManageVirtualServers-virsh"></span>Enable Virsh Console</h2></div>
</div>
</div>
<div class="columnLayout single" data-layout="single">
<div class="cell normal" data-type="normal">
<div class="innerCell">
<p>You can use the Virsh console to access a virtual server from a compute resource secure shell and perform various administrative tasks. You can enable the Virsh console for the following instances:</p><ul><li>Virtual servers that run on KVM compute resources.</li><li>Virtual servers that are built on Linux templates.</li><li>Virtual servers that are not built from ISO.</li></ul><p>You can enable <em>Default Virsh Console Policy</em> via <strong><a href="https://docs.onapp.com/display/VHS9AG/Edit+Defaults+Configuration">Settings</a></strong> for all newly created virtual servers to have Virsh console by default. For virtual servers that are created before you edit the settings, you can enable the console as follows:</p><ol><li>Go to your Control Panel &gt; <strong>Cloud</strong> &gt; <strong>Virtual Servers</strong>.</li><li>Click a label of a destination virtual server.</li><li>Click <strong>Actions, </strong>point to <strong>Options</strong>,<strong> </strong>and then click <strong>Enable Virsh Console</strong>. </li><li><span>In the dialogue box, click </span><strong>OK</strong><span> to confirm.</span></li></ol><p><span>After you confirm the action, the virtual server is rebooted and you can access it via the Virsh console. <br/></span></p><p><span>To access the virtual server via the Virsh console, follow the next steps:</span></p><ol><li><span>Connect via SSH to the destination compute resource. </span></li><li><p><span>Run the following command to list guest VSs using Virsh: <br/></span></p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">virsh list
Id    Name                           State
---------------------------------------------
1     freebsd						running
2     ubuntu						running
3     centos						running</pre>
</div></div></li><li><p>Run the following command from the compute resource to log in to the guest named <em>ubuntu</em>: </p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">virsh console ubuntu</pre>
</div></div><p><span>To exit the console, press </span><strong>CTRL + 5</strong><span>.</span></p></li></ol></div>
</div>
</div>
<div class="columnLayout single" data-layout="single">
<div class="cell normal" data-type="normal">
<div class="innerCell">
<hr/><h2 id="ManageVirtualServers-deleteDeleteVirtualServer"><span class="confluence-anchor-link" id="ManageVirtualServers-delete"></span>Delete Virtual Server</h2></div>
</div>
</div>
<div class="columnLayout single" data-layout="single">
<div class="cell normal" data-type="normal">
<div class="innerCell">
<p>Shut down the virtual server before destroying it. If you are deleting a VS that is running, the VS will be deleted after the time set in the Timeout Before Shutting Down VS configuration parameter.<br/>To remove the virtual server from the cloud:</p><ol><li>Go to your Control Panel &gt; <strong>Cloud</strong> &gt; <strong>Virtual Servers</strong> menu.</li><li>On the screen that appears, you'll see the list of all virtual servers in the cloud. Click the label of the virtual server you want to delete.</li><li>On the virtual server's screen, click the <strong>Actions </strong>button, point to <strong>Options</strong>, then select <strong>Delete Virtual Server.</strong></li><li>Move the <strong>Move Last Backup to My Templates if it is present </strong>slider to the right if you want to save the last VS's backup as a template.</li><li>Move the <strong>Destroy All Existing Backups</strong> slider to the right if you want to remove all existing backups of this virtual server.</li></ol><div class="confluence-information-macro confluence-information-macro-note"><span class="aui-icon aui-icon-small aui-iconfont-warning confluence-information-macro-icon"></span><div class="confluence-information-macro-body"><p>IMPORTANT:</p><ul><li>You won't be able to restore a virtual server after deleting it.</li><li>Deleting a virtual server removes all data stored on that virtual server. To save the data stored on the virtual server, back up your virtual server and select the <strong>Move Last Backup to My Templates if it is present</strong><span> box when following the instructions described in this section.</span></li><li>To delete a virtual server together with its backups, the user needs to have the <em>Destroy any backup</em> or <em>Destroy own backup</em> permission enabled. Otherwise, the backups of the VS deleted by the user will remain in the system.</li></ul></div></div></div>
</div>
</div>
</div>
                    </div>

                                                            <div class="pageSection group">
                        <div class="pageSectionHeader">
                            <h2 id="attachments" class="pageSectionTitle">Attachments:</h2>
                        </div>

                        <div class="greybox" align="left">
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/195791509/195791512.png">image2021-4-7_16-34-16.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/195791509/195791513.png">image2022-5-6_14-20-35.png</a> (image/png)
                                <br/>
                                                    </div>
                    </div>
                    
                                                      
                </div>             </div> 
            <div id="footer" role="contentinfo">
                <section class="footer-body">
                    <p>Document generated by Confluence on May 07, 2024 09:23</p>
                    <div id="footer-logo"><a href="https://www.atlassian.com/">Atlassian</a></div>
                </section>
            </div>
        </div>     </body>
</html>
